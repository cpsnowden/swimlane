on:
  push:
    branches: ["master"]

jobs:
  build:
    runs-on: ubuntu-latest
    name: Build Application
    steps:
      - name: Checkout the code
        uses: actions/checkout@master
      - name: Set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 1.11

      - name: Validate Gradle wrapper
        uses: gradle/wrapper-validation-action@ccb4328a959376b642e027874838f60f8e596de3

      - name: Build with Gradle
        uses: gradle/gradle-build-action@749f47bda3e44aa060e82d7b3ef7e40d953bd629
        with:
          arguments: build

      - name: Upload Build Artifact
        uses: actions/upload-artifact@v1
        with:
          name: quarkus-app-jvm
          path: build/quarkus-app

  dockerize:
    runs-on: ubuntu-latest
    name: Build Docker Image
    steps:
    - name: Dockerize
      uses: maxday/quarkus-dockerize-action@master
      with:
        tag: swimlane
        executablePath: '''
        dockerfilePath: src/main/docker/Dockerfile.jvm
    - name: Listing
      run: |
        ls -ltR